package menu

import (
	"fmt"

	"github.com/xraph/forgeui"
	"github.com/xraph/forgeui/alpine"
	"github.com/xraph/forgeui/animation"

	g "maragu.dev/gomponents"
	"maragu.dev/gomponents/html"
)

// SidebarProps defines sidebar configuration
type SidebarProps struct {
	DefaultCollapsed bool
	Collapsible      bool
	Side             forgeui.Side
	Class            string
	Attrs            []g.Node
}

// SidebarOption is a functional option for configuring sidebar
type SidebarOption func(*SidebarProps)

// WithDefaultCollapsed sets initial collapsed state
func WithDefaultCollapsed(collapsed bool) SidebarOption {
	return func(p *SidebarProps) { p.DefaultCollapsed = collapsed }
}

// WithCollapsible allows sidebar to be collapsed
func WithCollapsible(collapsible bool) SidebarOption {
	return func(p *SidebarProps) { p.Collapsible = collapsible }
}

// WithSide sets sidebar position (left or right)
func WithSide(side forgeui.Side) SidebarOption {
	return func(p *SidebarProps) { p.Side = side }
}

// WithSidebarClass adds custom classes to sidebar
func WithSidebarClass(class string) SidebarOption {
	return func(p *SidebarProps) { p.Class = class }
}

// WithSidebarAttrs adds custom attributes to sidebar
func WithSidebarAttrs(attrs ...g.Node) SidebarOption {
	return func(p *SidebarProps) { p.Attrs = append(p.Attrs, attrs...) }
}

// defaultSidebarProps returns default sidebar property values
func defaultSidebarProps() *SidebarProps {
	return &SidebarProps{
		DefaultCollapsed: false,
		Collapsible:      true,
		Side:             forgeui.SideLeft,
	}
}

// Sidebar creates a collapsible sidebar navigation
//
// Example:
//
//	menu.Sidebar(
//	    menu.SidebarHeader(g.Text("My App")),
//	    menu.SidebarContent(
//	        menu.Section("Main",
//	            menu.Item("/dashboard", g.Text("Dashboard")),
//	            menu.Item("/users", g.Text("Users")),
//	        ),
//	    ),
//	    menu.SidebarFooter(g.Text("Â© 2024")),
//	)
func Sidebar(children ...g.Node) g.Node {
	return SidebarWithOptions(nil, children...)
}

// SidebarWithOptions creates sidebar with custom options
func SidebarWithOptions(opts []SidebarOption, children ...g.Node) g.Node {
	props := defaultSidebarProps()
	for _, opt := range opts {
		opt(props)
	}

	sideClass := ""
	if props.Side == forgeui.SideLeft {
		sideClass = "left-0"
	} else {
		sideClass = "right-0"
	}

	classes := "fixed top-0 bottom-0 z-30 flex flex-col bg-sidebar text-sidebar-foreground border-border border-r transition-all duration-300 group/sidebar " + sideClass
	if props.Class != "" {
		classes += " " + props.Class
	}

	attrs := []g.Node{
		html.Class(classes),
		g.Attr("x-data", `{
			collapsed: `+fmt.Sprintf("%t", props.DefaultCollapsed)+`,
			mobileOpen: false,
			collapsible: `+fmt.Sprintf("%t", props.Collapsible)+`,
			isMobile: false
		}`),
		g.Attr("x-init", `
			isMobile = window.innerWidth < 768;
			// Register global store
			if (!Alpine.store('sidebar')) {
				Alpine.store('sidebar', {
					collapsed: collapsed,
					mobileOpen: mobileOpen,
					isMobile: isMobile
				});
			}
			// Watch for changes and update store
			$watch('collapsed', value => Alpine.store('sidebar').collapsed = value);
			$watch('mobileOpen', value => Alpine.store('sidebar').mobileOpen = value);
			$watch('isMobile', value => Alpine.store('sidebar').isMobile = value);
			// Handle resize
			window.addEventListener('resize', () => {
				isMobile = window.innerWidth < 768;
			});
		`),
		g.Attr(":class", "isMobile ? (mobileOpen ? 'w-64' : 'w-0') : (collapsed ? 'w-16' : 'w-64')"),
	}
	attrs = append(attrs, props.Attrs...)

	return g.Group([]g.Node{
		// Sidebar container
		html.Aside(
			g.Group(attrs),
			g.Group(children),
		),

		// Mobile backdrop
		html.Div(
			g.Attr("x-show", "isMobile && mobileOpen"),
			alpine.XOn("click", "mobileOpen = false"),
			g.Group(alpine.XTransition(animation.FadeIn())),
			html.Class("fixed inset-0 z-20 bg-background/80 backdrop-blur-sm md:hidden"),
		),

		// Mobile toggle button
		html.Button(
			g.Attr("type", "button"),
			g.Attr("x-show", "isMobile && !mobileOpen"),
			alpine.XOn("click", "mobileOpen = true"),
			html.Class("fixed top-4 left-4 z-10 md:hidden inline-flex items-center justify-center rounded-md p-2 bg-background border shadow-md text-muted-foreground hover:bg-accent hover:text-accent-foreground"),
			g.Attr("aria-label", "Open sidebar"),
			g.El("svg",
				html.Class("h-6 w-6"),
				g.Attr("xmlns", "http://www.w3.org/2000/svg"),
				g.Attr("fill", "none"),
				g.Attr("viewBox", "0 0 24 24"),
				g.Attr("stroke", "currentColor"),
				g.El("path",
					g.Attr("stroke-linecap", "round"),
					g.Attr("stroke-linejoin", "round"),
					g.Attr("stroke-width", "2"),
					g.Attr("d", "M4 6h16M4 12h16M4 18h16"),
				),
			),
		),
	})
}

// SidebarHeader creates the sidebar header section
//
// Example:
//
//	menu.SidebarHeader(
//	    html.Img(g.Attr("src", "/logo.svg")),
//	    g.Text("My App"),
//	)
func SidebarHeader(children ...g.Node) g.Node {
	return html.Div(
		html.Class("flex items-center gap-2 border-b border-border px-4 py-4 font-semibold"),
		g.Attr(":class", "collapsed && !isMobile ? 'justify-center' : ''"),
		html.Div(
			g.Attr("x-show", "!collapsed || isMobile"),
			g.Group(children),
		),
	)
}

// SidebarContent creates the main navigation area
//
// Example:
//
//	menu.SidebarContent(
//	    menu.Section("Main",
//	        menu.Item("/", g.Text("Home")),
//	    ),
//	)
func SidebarContent(children ...g.Node) g.Node {
	return html.Div(
		html.Class("flex-1 overflow-y-auto p-4"),
		g.Group(children),
	)
}

// SidebarFooter creates the sidebar footer section
//
// Example:
//
//	menu.SidebarFooter(
//	    menu.Item("#", g.Text("Settings")),
//	)
func SidebarFooter(children ...g.Node) g.Node {
	return html.Div(
		html.Class("border-t border-border p-4"),
		g.Group(children),
	)
}

// SidebarToggle creates a collapse/expand toggle button
//
// Example:
//
//	menu.SidebarToggle()
func SidebarToggle() g.Node {
	return html.Button(
		g.Attr("type", "button"),
		g.Attr("x-show", "collapsible && !isMobile"),
		alpine.XOn("click", "collapsed = !collapsed"),
		html.Class("absolute -right-3 top-20 z-40 flex h-6 w-6 items-center justify-center rounded-full border border-border bg-sidebar shadow-md text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground transition-transform"),
		g.Attr("aria-label", "Toggle sidebar"),

		// Single chevron that rotates
		g.El("svg",
			html.Class("h-4 w-4 transition-transform duration-200"),
			g.Attr(":class", "collapsed ? 'rotate-180' : ''"),
			g.Attr("xmlns", "http://www.w3.org/2000/svg"),
			g.Attr("fill", "none"),
			g.Attr("viewBox", "0 0 24 24"),
			g.Attr("stroke", "currentColor"),
			g.El("path",
				g.Attr("stroke-linecap", "round"),
				g.Attr("stroke-linejoin", "round"),
				g.Attr("stroke-width", "2"),
				g.Attr("d", "m15 18-6-6 6-6"),
			),
		),
	)
}

// SidebarLayout creates a layout wrapper that adjusts content for sidebar width
//
// Example:
//
//	menu.SidebarLayout(
//	    menu.Sidebar(...),
//	    html.Main(...), // your content
//	)
func SidebarLayout(children ...g.Node) g.Node {
	return html.Div(
		html.Class("min-h-screen"),
		g.Group(children),
	)
}

// SidebarLayoutContent creates content area that respects sidebar width
//
// Example:
//
//	menu.SidebarLayoutContent(
//	    html.Div(...), // your page content
//	)
func SidebarLayoutContent(children ...g.Node) g.Node {
	return html.Div(
		html.Class("transition-all duration-300 min-h-screen"),
		g.Attr("x-data", "{}"),
		g.Attr(":class", `{
			'ml-64': $store.sidebar && !$store.sidebar.isMobile && !$store.sidebar.collapsed,
			'ml-16': $store.sidebar && !$store.sidebar.isMobile && $store.sidebar.collapsed,
			'ml-0': !$store.sidebar || $store.sidebar.isMobile
		}`),
		g.Group(children),
	)
}

// SidebarGroup creates a collapsible group within the sidebar
//
// Example:
//
//	menu.SidebarGroup(
//	    menu.SidebarGroupLabel("Projects"),
//	    menu.SidebarMenu(...),
//	)
func SidebarGroup(children ...g.Node) g.Node {
	return html.Div(
		html.Class("space-y-2"),
		g.Group(children),
	)
}

// SidebarGroupProps defines collapsible sidebar group configuration
type SidebarGroupProps struct {
	Collapsible    bool
	DefaultOpen    bool
	CollapsibleKey string
	Class          string
}

// SidebarGroupOption is a functional option for configuring collapsible sidebar groups
type SidebarGroupOption func(*SidebarGroupProps)

// WithGroupCollapsible makes the group collapsible
func WithGroupCollapsible() SidebarGroupOption {
	return func(p *SidebarGroupProps) { p.Collapsible = true }
}

// WithGroupDefaultOpen sets the default open state
func WithGroupDefaultOpen(open bool) SidebarGroupOption {
	return func(p *SidebarGroupProps) { p.DefaultOpen = open }
}

// WithGroupKey sets a unique key for the collapsible state
func WithGroupKey(key string) SidebarGroupOption {
	return func(p *SidebarGroupProps) { p.CollapsibleKey = key }
}

// WithGroupClass adds custom classes
func WithGroupClass(class string) SidebarGroupOption {
	return func(p *SidebarGroupProps) { p.Class = class }
}

// defaultSidebarGroupProps returns default group properties
func defaultSidebarGroupProps() *SidebarGroupProps {
	return &SidebarGroupProps{
		Collapsible:    false,
		DefaultOpen:    true,
		CollapsibleKey: "group",
	}
}

// SidebarGroupCollapsible creates a collapsible group with animation
//
// Example:
//
//	menu.SidebarGroupCollapsible(
//	    []SidebarGroupOption{menu.WithGroupKey("projects"), menu.WithGroupDefaultOpen(true)},
//	    menu.SidebarGroupLabel("Projects"),
//	    menu.SidebarMenu(...),
//	)
func SidebarGroupCollapsible(opts []SidebarGroupOption, children ...g.Node) g.Node {
	props := defaultSidebarGroupProps()
	for _, opt := range opts {
		opt(props)
	}

	classes := "space-y-2"
	if props.Class != "" {
		classes = forgeui.CN(classes, props.Class)
	}

	return html.Div(
		html.Class(classes),
		g.Attr("x-data", fmt.Sprintf("{ %s_open: %t }", props.CollapsibleKey, props.DefaultOpen)),
		g.Group(children),
	)
}

// SidebarGroupLabel creates a label for a sidebar group
//
// Example:
//
//	menu.SidebarGroupLabel("Navigation")
func SidebarGroupLabel(text string, children ...g.Node) g.Node {
	nodes := []g.Node{g.Text(text)}
	if len(children) > 0 {
		nodes = append(nodes, children...)
	}

	return html.Div(
		html.Class("px-3 text-xs font-semibold text-sidebar-foreground/70 uppercase tracking-wider mb-2"),
		g.Attr(":class", "collapsed && !isMobile ? 'opacity-0 h-0 overflow-hidden' : ''"),
		g.Group(nodes),
	)
}

// SidebarGroupLabelCollapsible creates a clickable label for collapsible groups
//
// Example:
//
//	menu.SidebarGroupLabelCollapsible("projects", "Projects", icon)
func SidebarGroupLabelCollapsible(key string, text string, icon g.Node) g.Node {
	return html.Button(
		g.Attr("type", "button"),
		alpine.XOn("click", fmt.Sprintf("%s_open = !%s_open", key, key)),
		html.Class("flex w-full items-center gap-2 px-3 py-2 text-xs font-semibold text-sidebar-foreground/70 uppercase tracking-wider hover:text-sidebar-foreground transition-colors"),
		g.Attr(":class", "collapsed && !isMobile ? 'justify-center' : ''"),
		html.Span(
			g.Attr("x-show", "!collapsed || isMobile"),
			g.Text(text),
		),
		html.Span(
			html.Class("ml-auto"),
			g.Attr("x-show", "!collapsed || isMobile"),
			g.El("svg",
				html.Class("h-4 w-4 transition-transform duration-200"),
				g.Attr(":class", fmt.Sprintf("%s_open ? 'rotate-180' : ''", key)),
				g.Attr("xmlns", "http://www.w3.org/2000/svg"),
				g.Attr("fill", "none"),
				g.Attr("viewBox", "0 0 24 24"),
				g.Attr("stroke", "currentColor"),
				g.El("path",
					g.Attr("stroke-linecap", "round"),
					g.Attr("stroke-linejoin", "round"),
					g.Attr("stroke-width", "2"),
					g.Attr("d", "m19 9-7 7-7-7"),
				),
			),
		),
	)
}

// SidebarGroupContent wraps collapsible group content
//
// Example:
//
//	menu.SidebarGroupContent("projects", menu.SidebarMenu(...))
func SidebarGroupContent(key string, children ...g.Node) g.Node {
	return html.Div(
		g.Attr("x-show", fmt.Sprintf("%s_open", key)),
		g.Attr("x-collapse", ""),
		html.Class("space-y-1"),
		g.Group(children),
	)
}

// SidebarGroupAction creates an action button for a group (e.g., "Add Project")
//
// Example:
//
//	menu.SidebarGroupAction(icons.Plus(), "Add Project")
func SidebarGroupAction(icon g.Node, label string) g.Node {
	return html.Button(
		g.Attr("type", "button"),
		html.Class("ml-auto opacity-0 group-hover:opacity-100 transition-opacity p-1 rounded-md hover:bg-sidebar-accent text-sidebar-foreground/70 hover:text-sidebar-foreground"),
		g.Attr("aria-label", label),
		icon,
	)
}

// SidebarMenu creates a menu list container
//
// Example:
//
//	menu.SidebarMenu(
//	    menu.SidebarMenuItem(...),
//	    menu.SidebarMenuItem(...),
//	)
func SidebarMenu(children ...g.Node) g.Node {
	return html.Div(
		html.Class("flex flex-col gap-1"),
		g.Group(children),
	)
}

// SidebarMenuItem creates a menu item container
//
// Example:
//
//	menu.SidebarMenuItem(
//	    menu.SidebarMenuButton(...),
//	)
func SidebarMenuItem(children ...g.Node) g.Node {
	return html.Div(
		html.Class("relative group/menu-item"),
		g.Group(children),
	)
}

// SidebarMenuButtonProps defines menu button configuration
type SidebarMenuButtonProps struct {
	Href     string
	Active   bool
	Icon     g.Node
	Badge    g.Node
	Tooltip  string
	AsButton bool
	Class    string
	Attrs    []g.Node
}

// SidebarMenuButtonOption is a functional option for menu buttons
type SidebarMenuButtonOption func(*SidebarMenuButtonProps)

// WithMenuHref sets the link URL
func WithMenuHref(href string) SidebarMenuButtonOption {
	return func(p *SidebarMenuButtonProps) { p.Href = href }
}

// WithMenuActive marks the menu item as active
func WithMenuActive() SidebarMenuButtonOption {
	return func(p *SidebarMenuButtonProps) { p.Active = true }
}

// WithMenuIcon adds an icon to the menu button
func WithMenuIcon(icon g.Node) SidebarMenuButtonOption {
	return func(p *SidebarMenuButtonProps) { p.Icon = icon }
}

// WithMenuBadge adds a badge to the menu button
func WithMenuBadge(badge g.Node) SidebarMenuButtonOption {
	return func(p *SidebarMenuButtonProps) { p.Badge = badge }
}

// WithMenuTooltip adds a tooltip for collapsed state
func WithMenuTooltip(text string) SidebarMenuButtonOption {
	return func(p *SidebarMenuButtonProps) { p.Tooltip = text }
}

// WithMenuAsButton renders as button instead of link
func WithMenuAsButton() SidebarMenuButtonOption {
	return func(p *SidebarMenuButtonProps) { p.AsButton = true }
}

// WithMenuClass adds custom classes
func WithMenuClass(class string) SidebarMenuButtonOption {
	return func(p *SidebarMenuButtonProps) { p.Class = class }
}

// WithMenuAttrs adds custom attributes
func WithMenuAttrs(attrs ...g.Node) SidebarMenuButtonOption {
	return func(p *SidebarMenuButtonProps) { p.Attrs = append(p.Attrs, attrs...) }
}

// defaultSidebarMenuButtonProps returns default menu button properties
func defaultSidebarMenuButtonProps() *SidebarMenuButtonProps {
	return &SidebarMenuButtonProps{
		Active:   false,
		AsButton: false,
	}
}

// SidebarMenuButton creates a menu button/link with icon and label
//
// Example:
//
//	menu.SidebarMenuButton(
//	    "Dashboard",
//	    menu.WithMenuHref("/dashboard"),
//	    menu.WithMenuIcon(icons.LayoutDashboard()),
//	    menu.WithMenuActive(),
//	)
func SidebarMenuButton(label string, opts ...SidebarMenuButtonOption) g.Node {
	props := defaultSidebarMenuButtonProps()
	for _, opt := range opts {
		opt(props)
	}

	baseClasses := "flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium transition-colors group-hover/menu-item:bg-sidebar-accent peer/menu-button"
	if props.Active {
		baseClasses += " bg-sidebar-accent text-sidebar-accent-foreground"
	} else {
		baseClasses += " text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground"
	}

	if props.Class != "" {
		baseClasses = forgeui.CN(baseClasses, props.Class)
	}

	// Build content nodes
	contentNodes := []g.Node{}

	// Add icon if provided
	if props.Icon != nil {
		contentNodes = append(contentNodes, html.Span(
			html.Class("shrink-0"),
			props.Icon,
		))
	}

	// Add label (hidden when collapsed)
	contentNodes = append(contentNodes, html.Span(
		g.Attr("x-show", "!collapsed || isMobile"),
		html.Class("flex-1"),
		g.Text(label),
	))

	// Add badge if provided
	if props.Badge != nil {
		contentNodes = append(contentNodes, html.Span(
			g.Attr("x-show", "!collapsed || isMobile"),
			html.Class("ml-auto"),
			props.Badge,
		))
	}

	attrs := []g.Node{html.Class(baseClasses)}
	attrs = append(attrs, props.Attrs...)

	if props.AsButton {
		attrs = append(attrs, g.Attr("type", "button"))
		return html.Button(
			g.Group(attrs),
			g.Group(contentNodes),
		)
	}

	// Render as link
	attrs = append(attrs, g.Attr("href", props.Href))
	if props.Tooltip != "" {
		attrs = append(attrs, g.Attr("title", props.Tooltip))
	}

	return html.A(
		g.Group(attrs),
		g.Group(contentNodes),
	)
}

// SidebarMenuSub creates a submenu container
//
// Example:
//
//	menu.SidebarMenuSub(
//	    menu.SidebarMenuSubItem(...),
//	    menu.SidebarMenuSubItem(...),
//	)
func SidebarMenuSub(children ...g.Node) g.Node {
	return html.Div(
		html.Class("ml-6 border-l border-border pl-4 space-y-1"),
		g.Attr("x-show", "!collapsed || isMobile"),
		g.Group(children),
	)
}

// SidebarMenuSubItem creates a submenu item
//
// Example:
//
//	menu.SidebarMenuSubItem(
//	    menu.SidebarMenuSubButton(...),
//	)
func SidebarMenuSubItem(children ...g.Node) g.Node {
	return html.Div(
		html.Class("relative"),
		g.Group(children),
	)
}

// SidebarMenuSubButton creates a submenu button/link
//
// Example:
//
//	menu.SidebarMenuSubButton("Settings", "/settings", false)
func SidebarMenuSubButton(label string, href string, active bool) g.Node {
	classes := "flex items-center gap-2 rounded-md px-3 py-1.5 text-sm transition-colors"
	if active {
		classes += " bg-sidebar-accent text-sidebar-accent-foreground font-medium"
	} else {
		classes += " text-sidebar-foreground/70 hover:bg-sidebar-accent hover:text-sidebar-foreground"
	}

	return html.A(
		g.Attr("href", href),
		html.Class(classes),
		g.Text(label),
	)
}

// SidebarMenuBadge creates a badge for menu items
//
// Example:
//
//	menu.SidebarMenuBadge("12")
func SidebarMenuBadge(text string) g.Node {
	return html.Span(
		html.Class("inline-flex items-center justify-center rounded-md bg-sidebar-primary px-2 py-0.5 text-xs font-medium text-sidebar-primary-foreground"),
		g.Text(text),
	)
}

// SidebarMenuAction creates an action button that appears on hover
//
// Example:
//
//	menu.SidebarMenuAction(icons.MoreVertical(), "Options")
func SidebarMenuAction(icon g.Node, label string, attrs ...g.Node) g.Node {
	return html.Button(
		g.Attr("type", "button"),
		html.Class("absolute right-1 top-1.5 opacity-0 group-hover/menu-item:opacity-100 peer-data-[active=true]/menu-button:opacity-100 transition-opacity p-1 rounded-md hover:bg-sidebar-accent text-sidebar-foreground/70 hover:text-sidebar-foreground"),
		g.Attr("aria-label", label),
		g.Attr("x-show", "!collapsed || isMobile"),
		g.Group(attrs),
		icon,
	)
}

// SidebarInset creates the main content area with proper layout
//
// Example:
//
//	menu.SidebarInset(
//	    menu.SidebarInsetHeader(...),
//	    html.Main(...),
//	)
func SidebarInset(children ...g.Node) g.Node {
	return html.Div(
		html.Class("relative flex min-h-screen flex-1 flex-col bg-background"),
		g.Attr("x-data", "{}"),
		g.Attr(":class", `{
			'md:ml-64': $store.sidebar && !$store.sidebar.collapsed,
			'md:ml-16': $store.sidebar && $store.sidebar.collapsed
		}`),
		html.Class("transition-all duration-300"),
		g.Group(children),
	)
}

// SidebarInsetHeader creates a header with sidebar trigger and breadcrumbs
//
// Example:
//
//	menu.SidebarInsetHeader(
//	    menu.SidebarTrigger(),
//	    breadcrumb.Breadcrumb(...),
//	)
func SidebarInsetHeader(children ...g.Node) g.Node {
	return html.Header(
		html.Class("sticky top-0 z-10 flex h-16 shrink-0 items-center gap-2 border-b bg-background px-4"),
		g.Group(children),
	)
}

// SidebarTrigger creates a trigger button for mobile/desktop
//
// Example:
//
//	menu.SidebarTrigger()
func SidebarTrigger() g.Node {
	return html.Button(
		g.Attr("type", "button"),
		html.Class("inline-flex items-center justify-center rounded-md p-2 text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground md:hidden"),
		g.Attr("aria-label", "Toggle sidebar"),
		alpine.XOn("click", "if ($store.sidebar) { if ($store.sidebar.isMobile) { $store.sidebar.mobileOpen = !$store.sidebar.mobileOpen } else { $store.sidebar.collapsed = !$store.sidebar.collapsed } }"),
		g.El("svg",
			html.Class("h-6 w-6"),
			g.Attr("xmlns", "http://www.w3.org/2000/svg"),
			g.Attr("fill", "none"),
			g.Attr("viewBox", "0 0 24 24"),
			g.Attr("stroke", "currentColor"),
			g.El("path",
				g.Attr("stroke-linecap", "round"),
				g.Attr("stroke-linejoin", "round"),
				g.Attr("stroke-width", "2"),
				g.Attr("d", "M4 6h16M4 12h16M4 18h16"),
			),
		),
	)
}

// SidebarTriggerDesktop creates a desktop-only trigger
//
// Example:
//
//	menu.SidebarTriggerDesktop()
func SidebarTriggerDesktop() g.Node {
	return html.Button(
		g.Attr("type", "button"),
		html.Class("hidden md:inline-flex items-center justify-center rounded-md p-2 text-muted-foreground hover:bg-accent hover:text-accent-foreground"),
		g.Attr("aria-label", "Toggle sidebar"),
		alpine.XOn("click", "if ($store.sidebar) { $store.sidebar.collapsed = !$store.sidebar.collapsed }"),
		g.El("svg",
			html.Class("h-5 w-5"),
			g.Attr("xmlns", "http://www.w3.org/2000/svg"),
			g.Attr("fill", "none"),
			g.Attr("viewBox", "0 0 24 24"),
			g.Attr("stroke", "currentColor"),
			g.El("path",
				g.Attr("stroke-linecap", "round"),
				g.Attr("stroke-linejoin", "round"),
				g.Attr("stroke-width", "2"),
				g.Attr("d", "M3 4h18M3 12h18M3 20h18"),
			),
		),
	)
}

// SidebarRail creates an invisible rail for better collapse interaction
//
// Example:
//
//	menu.SidebarRail()
func SidebarRail() g.Node {
	return html.Button(
		g.Attr("type", "button"),
		html.Class("absolute inset-y-0 -right-4 z-20 hidden w-4 cursor-pointer md:block"),
		g.Attr("aria-label", "Toggle sidebar"),
		alpine.XOn("click", "if ($store.sidebar && $store.sidebar.collapsible) { $store.sidebar.collapsed = !$store.sidebar.collapsed }"),
		g.Attr("x-show", "!isMobile"),
	)
}
